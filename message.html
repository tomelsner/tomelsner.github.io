<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<title>Test</title>

<script type="text/javascript">


	function awaitPostMessage() {
	  var isReactNativePostMessageReady = !!window.originalPostMessage;
	  var queue = [];
	  var currentPostMessageFn = function store(message) {
		if (queue.length > 100) queue.shift();
		queue.push(message);
	  };
	  if (!isReactNativePostMessageReady) {
		var originalPostMessage = window.postMessage;
		Object.defineProperty(window, 'postMessage', {
		  configurable: true,
		  enumerable: true,
		  get: function () {
			return currentPostMessageFn;
		  },
		  set: function (fn) {
			currentPostMessageFn = fn;
			isReactNativePostMessageReady = true;
			setTimeout(sendQueue, 0);
		  }
		});
		window.postMessage.toString = function () {
		  return String(originalPostMessage);
		};
	  }

	  function sendQueue() {
		while (queue.length > 0) window.postMessage(queue.shift());
	  }
	}

	var callReactNative = function() {
		window.postMessage('{"reservation_id":"469457TEST","property_code":"HYSFRA01","adults":"1","children":"0","total":"219.00","in":"22.12.2017","out":"23.12.2017","hotel_id":"16","hotel_name":"Steigenberger Frankfurter Hof","images":{"highres":["https:\/\/steigenberger.workmatrix.com\/cache\/images\/44521_SHR_Frankfurte_7e05a032b5a032a59b67d8b-1.jpg","https:\/\/steigenberger.workmatrix.com\/cache\/images\/44521_SHR_Frankfurte_6505a032c5a032a59b67d9d-1.jpg","https:\/\/steigenberger.workmatrix.com\/cache\/images\/44521_SHR_Frankfurte_1605a032b5a032a59b67dab-1.jpg"],"lowres":["https:\/\/steigenberger.workmatrix.com\/cache\/images\/44521_SHR_Frankfurte_8605a032b2ee1a659b67d8d-1.jpg","https:\/\/steigenberger.workmatrix.com\/cache\/images\/44521_SHR_Frankfurte_4b05a032c2ee1a659b67d9f-1.jpg","https:\/\/steigenberger.workmatrix.com\/cache\/images\/44521_SHR_Frankfurte_005a032b2ee1a659b67dad-1.jpg"]}}','*');

		
		/*function whenRNPostMessageReady(cb) {
			if (window.postMessage.length !== 1) {
				setTimeout(function() { whenRNPostMessageReady(cb) }, 100);
			} else {
				cb();
			}
		}
	
		whenRNPostMessageReady(function() {
			postMessage('{"reservation_id":"469457TEST","property_code":"HYSFRA01","adults":"1","children":"0","total":"219.00","in":"22.12.2017","out":"23.12.2017","hotel_id":"16","hotel_name":"Steigenberger Frankfurter Hof","images":{"highres":["https:\/\/steigenberger.workmatrix.com\/cache\/images\/44521_SHR_Frankfurte_7e05a032b5a032a59b67d8b-1.jpg","https:\/\/steigenberger.workmatrix.com\/cache\/images\/44521_SHR_Frankfurte_6505a032c5a032a59b67d9d-1.jpg","https:\/\/steigenberger.workmatrix.com\/cache\/images\/44521_SHR_Frankfurte_1605a032b5a032a59b67dab-1.jpg"],"lowres":["https:\/\/steigenberger.workmatrix.com\/cache\/images\/44521_SHR_Frankfurte_8605a032b2ee1a659b67d8d-1.jpg","https:\/\/steigenberger.workmatrix.com\/cache\/images\/44521_SHR_Frankfurte_4b05a032c2ee1a659b67d9f-1.jpg","https:\/\/steigenberger.workmatrix.com\/cache\/images\/44521_SHR_Frankfurte_005a032b2ee1a659b67dad-1.jpg"]}}');
		});*/
	}

	/*
	
	awaitPostMessage();
	window.postMessage('{"reservation_id":"469457TEST",
	    "property_code":"HYSFRA01",
	    "adults":"1",
	    "children":"0",
	    "total":"219.00",
	    "in":"22.12.2017",
	    "out":"23.12.2017",
	    "hotel_id":"16",
	    "hotel_name":"Steigenberger Frankfurter Hof","images":{"highres":["https:\/\/steigenberger.workmatrix.com\/cache\/images\/44521_SHR_Frankfurte_7e05a032b5a032a59b67d8b-1.jpg","https:\/\/steigenberger.workmatrix.com\/cache\/images\/44521_SHR_Frankfurte_6505a032c5a032a59b67d9d-1.jpg","https:\/\/steigenberger.workmatrix.com\/cache\/images\/44521_SHR_Frankfurte_1605a032b5a032a59b67dab-1.jpg"],"lowres":["https:\/\/steigenberger.workmatrix.com\/cache\/images\/44521_SHR_Frankfurte_8605a032b2ee1a659b67d8d-1.jpg","https:\/\/steigenberger.workmatrix.com\/cache\/images\/44521_SHR_Frankfurte_4b05a032c2ee1a659b67d9f-1.jpg","https:\/\/steigenberger.workmatrix.com\/cache\/images\/44521_SHR_Frankfurte_005a032b2ee1a659b67dad-1.jpg"]}});

	*/
    
/*
window.onLoad = function(){
	alert('window on load');
	setTimeout(function () {
		window.postMessage('send to react native from index inline after onload, delay 0 milliscond', '*')
	}, 0);
	setTimeout(function () {
		window.postMessage('send to react native from index inline after onload, delay 200 milliscond', '*')
	}, 200);
	
	
	
}; 
*/


	//window.postMessage('send to react native from index inline, no delay', '*')

	/*setTimeout(function () {
		window.postMessage('send to react native from index inline, delay 200 milliscond', '*')
	}, 200);
	*/
	





</script>

</head>
<body onLoad="callReactNative();">
<a onClick="window.postMessage('yes');">18</a>
</body>
</html>